# .template Directory

This directory contains the infrastructure used to initialize and maintain the Lumina project itself. 

**Important Distinction**: This .template/ directory is for the TEMPLATE infrastructure, not for projects created FROM the template.

---

## Contents

### Setup Infrastructure

- **`scripts/init.sh`**: One-time setup script run when initializing a new project
  - Prompts for project name, customer name, and user name
  - Allows selection of MCP servers to enable
  - Generates `.vscode/mcp.json` configuration
  - Run with: `./.template/scripts/init.sh`

- **`templates/`**: Read-only template files for initializing `aiDocs/`
  - `SUMMARY.template.md` - Project summary template
  - `TASKS.template.md` - Task tracking template
  - `DISCOVERY.template.md` - Discovery questions template
  - `AI.template.md` - AI agent notes template
  - Used by `.template/scripts/clean-reset.sh` to reset project state

- **`mcpServers/`**: MCP server configuration options
  - Pre-configured JSON files for various MCP servers
  - Users select which to enable during `scripts/init.sh`
  - Add new server configs here as `.json` files

- **`scripts/`**: Template infrastructure scripts
  - `init.sh` - One-time project setup script
  - `clean-reset.sh` - Reset project to template state
  - `install-hooks.sh` - Install git pre-commit hooks for validation

### Quality Automation

- **`.github/workflows/pr-validation.yml`**: GitHub Actions workflow
  - Validates PR labels, branch naming, commit format
  - Runs syntax checks on bash and Python scripts
  - Enforces contribution standards automatically
  - Runs on every PR

- **`.githooks/pre-commit`**: Pre-commit validation hook
  - Validates bash and Python syntax before commits
  - Checks commit message format
  - Ensures issue references in commits
  - Install with: `.template/scripts/install-hooks.sh`

### Bootstrap Maintenance

- **`prompts/`**: Workflows for maintaining the bootstrap template itself
  - `sanityCheck.prompt.md` - Fast pre-commit validation (critical issues only)
  - `healthCheck.prompt.md` - Comprehensive QA analysis of bootstrap
  - `generateTasks.prompt.md` - Convert findings to actionable tasks
  - Use `/sanityCheck`, `/healthCheck`, and `/generateTasks` slash commands

- **`SANITY_CHECK_REPORT.md`**: Latest validation results
  - Quick validation for pre-commit checks
  - Critical issues only
  - Git-aware (analyzes uncommitted files or full codebase)
  - Generated by `/sanityCheck`
  
- **`HEALTH_CHECK_REPORT.md`**: Comprehensive bootstrap analysis
  - Overall health assessment
  - Identified issues by severity (all levels)
  - Component-by-component analysis
  - Generated by `/healthCheck`

- **GitHub Issues**: Bug/fix/enhancement tracking for the bootstrap template
  - Use labels and milestones instead of markdown files
  - Created via `/reportToGitHub` from health/sanity reports

### Workflow Infrastructure & Automation

**Purpose**: Standard workflows and automated quality enforcement for the template

**Files created in root (not .template):**

- **`CONTRIBUTING.md`**: Comprehensive developer guidelines (human-readable)
  - Git branching strategy (`defect/` vs `feature/` prefixes)
  - Conventional commit format with examples
  - Complete label and milestone reference tables
  - PR process template and code quality standards
  - **Created during**: `init.sh` setup (copied from template)

- **`prompts/completeIssue.prompt.md`**: Issue-to-PR workflow (AI invokable)
  - Complete 6-step workflow: Fetch issue → Branch → Implement → Test → Commit → PR
  - Examples for both bug fixes and features
  - Automated via `/completeIssue` command for AI agents
  - Enforces contribution standards automatically
  - **Created during**: `init.sh` setup (copied from template)

- **`.github/copilot-instructions.md`**: Core AI agent instructions
  - Quick reference for common workflows
  - Links to detailed documentation (CONTRIBUTING.md, prompts)
  - Universal rules for all agents
  - Kept concise (~100 lines) for AI processing effectiveness
  - **Created during**: `init.sh` setup (copied from template)

- **`.github/workflows/pr-validation.yml`**: GitHub Actions PR validation
  - Validates PR labels, branch naming (`defect/`|`feature/`)
  - Checks commit message format (conventional commits)
  - Runs bash and Python syntax validation
  - Ensures issue references in commits
  - Enforces contribution standards automatically
  - **Runs on**: Every pull request

- **`.githooks/pre-commit`**: Pre-commit validation hook
  - Validates bash and Python syntax before commits
  - Checks commit message format (type(scope): description)
  - Ensures issue references in commits (Fixes #N, Refs #N)
  - Color-coded output (red errors, green success, yellow warnings)
  - **Install with**: `.template/scripts/install-hooks.sh`

**Installation**:
```bash
# Install git hooks for local validation
./.template/scripts/install-hooks.sh
```

**Usage**:
- **Developers**: Read `CONTRIBUTING.md` for workflow guidelines
- **AI Agents**: Use `/completeIssue` to automate Issue→PR workflow
- **Automation**: Pre-commit hooks + GitHub Actions enforce standards

---

## .template vs. Project

### .template Directory (this directory)

- **Purpose**: Infrastructure for creating and maintaining the template
- **Users**: Template maintainers and developers
- **Frequency**: Used once during setup, then for template maintenance
- **Scope**: The template itself, not individual projects

**Contains**:
- Setup scripts (`scripts/`)
- Template files
- MCP server configs
- Bootstrap maintenance prompts
- Bootstrap issue tracking

### Root Directory

- **Purpose**: Active project tools and workflows
- **Users**: Project teams using the template
- **Frequency**: Used continuously throughout project lifecycle
- **Scope**: Individual projects created from template

**Contains**:
- User workflows (`prompts/`)
- Project data (`aiDocs/`, `email/`)
- Project tracking (`PROJECT.md`, `docs/`)

---

## When to Use Bootstrap Tools

### Run `/sanityCheck` when:
- Before committing changes to template
- Quick validation of critical issues only
- Checking uncommitted file changes
- Fast pre-commit workflow (completes in seconds)

### Run `/healthCheck` when:
- Performing comprehensive template analysis
- Before releasing new template version
- Planning major template improvements
- Need detailed component-by-component review
- Analyzing all severity levels (not just critical)

### Run `/generateTasks` when:
- Health check identifies issues
- Planning bootstrap improvements
- Creating actionable fix lists
- Prioritizing maintenance work

### Edit bootstrap files when:
- Adding new MCP server configs
- Updating template files
- Fixing bootstrap bugs
- Improving setup experience

---

## Decision Criteria

**Does it belong in .template/?**

| Question | Yes → .template | No → Root |
|----------|----------------|-----------|
| Used only during initial setup? | ✅ | ❌ |
| Read-only after setup? | ✅ | ❌ |
| Maintains the template itself? | ✅ | ❌ |
| Part of scaffolding/initialization? | ✅ | ❌ |
| Users modify/run continuously? | ❌ | ✅ |
| Part of ongoing project workflow? | ❌ | ✅ |

---

## Examples

### .template Items (in this directory)
- `scripts/init.sh` - Only runs once during setup
- `scripts/clean-reset.sh` - Reset project to template state
- `templates/` - Read-only scaffolding
- `mcpServers/` - Read once during init
- Bootstrap maintenance prompts

### Root Items (outside this directory)
- `prompts/` - Used continuously by project teams
- Project data and documentation

---

## Maintaining the Template

To maintain the template infrastructure itself:

1. **Quick validation**: Run `/sanityCheck` before commits
2. **Comprehensive analysis**: Run `/healthCheck` periodically
3. **Review reports**: Check `SANITY_CHECK_REPORT.md` or `HEALTH_CHECK_REPORT.md`
4. **Create GitHub issues**: Run `/reportToGitHub` to convert reports into issues
5. **Prioritize work**: Use GitHub labels/milestones (no markdown task files)
6. **Implement fixes**: Work through issues by priority
7. **Validate changes**: Re-run `/sanityCheck` or `/healthCheck`
8. **Close issues**: Link PRs to GitHub issues and close via merge

---

## Adding New MCP Servers

To add a new MCP server configuration:

1. Create `.json` file in `.template/mcpServers/`
2. Follow existing config format:
   ```json
   {
     "mcpServers": {
       "server-name": {
         "command": "command-to-run",
         "args": ["arg1", "arg2"],
         "env": {
           "VAR": "value"
         }
       }
     }
   }
   ```
3. Users can select it during `./.template/init.sh`

---

## Template Updates

When updating template files in `.template/templates/`:

1. Edit the `.template.md` files
2. Ensure placeholders use `[BRACKETS]` format
3. Test with `./.template/scripts/clean-reset.sh`
4. Run `/sanityCheck` for quick validation
5. Run `/healthCheck` for comprehensive review
6. Document changes in bootstrap tracking files

---

## References

- **For template fixes/enhancements**: See GitHub Issues
- **For template usage**: See root `GETTING_STARTED.md`
- **For AI workflows**: See `.github/copilot-instructions.md`
